{"openapi":"3.1.0","info":{"title":"clairo-asgard","description":"Clairo Asgard Backend API","version":"1.0.0"},"paths":{"/api/v1/health":{"get":{"tags":["API V1","health","system"],"summary":"Liveness probe","description":"Returns a lightweight 'I am alive' JSON payload.\n\nExtend this later to include read/write checks for DB, cache, etc.","operationId":"health_check_api_v1_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"}}}},"/api/v1/health/comprehensive":{"get":{"tags":["API V1","health","system"],"summary":"Comprehensive health check","description":"Returns comprehensive health information including cache status.\n\nThis endpoint will interact with the cache system and provide detailed\nhealth information including response times and metrics.","operationId":"comprehensive_health_check_api_v1_health_comprehensive_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ComprehensiveHealthResponse"}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"}}}},"/api/v1/health/circuit-breakers":{"get":{"tags":["API V1","health","system"],"summary":"Get status of all circuit breakers across all services","description":"Get status of all circuit breakers across all services.","operationId":"get_circuit_breaker_status_api_v1_health_circuit_breakers_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CircuitBreakerResponse"}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"}}}},"/api/v1/info":{"get":{"tags":["API V1","info","system"],"summary":"API version information","description":"Get information about all API versions.","operationId":"get_api_info_api_v1_info_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/APIInfoResponse"}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"}}}},"/api/v1/users/sync":{"post":{"tags":["API V1","users","authentication"],"summary":"Sync User From Jwt","description":"Sync user profile from JWT claims.","operationId":"sync_user_from_jwt_api_v1_users_sync_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserItem"}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"}}}},"/api/v1/users/me":{"get":{"tags":["API V1","users","authentication"],"summary":"Get Current User Profile","description":"Get current user's profile information.","operationId":"get_current_user_profile_api_v1_users_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserItem"}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"}}}},"/api/v1/orgs":{"get":{"tags":["API V1","orgs"],"summary":"Get user's organizations","description":"Returns all organizations where the user has ACTIVE membership, ordered by name. Returns 204 if no organizations found.","operationId":"get_user_organizations_api_v1_orgs_get","responses":{"200":{"description":"Organizations found","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/OrganizationItem"},"type":"array","title":"Response Get User Organizations Api V1 Orgs Get"}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"},"204":{"description":"No organizations found"}}},"post":{"tags":["API V1","orgs"],"summary":"Create new organization","description":"Create a new organization with the caller as ORG_ADMIN.","operationId":"create_organization_api_v1_orgs_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationCreateRequest"}}},"required":true},"responses":{"201":{"description":"Organization created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationItem"}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"},"409":{"description":"Organization with this code already exists"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/orgs/{org_id}":{"get":{"tags":["API V1","orgs"],"summary":"Get organization by ID","description":"Get organization details if user has active membership.","operationId":"get_organization_api_v1_orgs__org_id__get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"}],"responses":{"200":{"description":"Organization found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationItem"}}}},"404":{"description":"Organization not found or no access"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["API V1","orgs"],"summary":"Update organization","description":"Update organization details. Requires ORG_ADMIN role.","operationId":"update_organization_api_v1_orgs__org_id__patch","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationUpdateRequest"}}}},"responses":{"200":{"description":"Organization updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrganizationItem"}}}},"404":{"description":"Organization not found or insufficient permissions"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["API V1","orgs"],"summary":"Delete organization","description":"Soft delete organization. Requires ORG_ADMIN role. By default, prevents deletion if resources exist. Use ?force=true to override.","operationId":"delete_organization_api_v1_orgs__org_id__delete","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"force","in":"query","required":false,"schema":{"type":"boolean","description":"Force deletion even if resources exist","default":false,"title":"Force"},"description":"Force deletion even if resources exist"}],"responses":{"204":{"description":"Organization deleted successfully"},"404":{"description":"Organization not found or insufficient permissions"},"500":{"description":"Internal server error"},"400":{"description":"Organization has resources that prevent deletion"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/orgs/{org_id}/teams":{"get":{"tags":["API V1","orgs"],"summary":"Get organization teams","description":"Returns all teams in the organization where user has active membership. Returns empty array if no teams found.","operationId":"get_organization_teams_api_v1_orgs__org_id__teams_get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"search","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Search teams by name (case-insensitive)","title":"Search"},"description":"Search teams by name (case-insensitive)"}],"responses":{"200":{"description":"Teams found or empty array","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TeamItem"},"title":"Response Get Organization Teams Api V1 Orgs  Org Id  Teams Get"}}}},"404":{"description":"Organization not found"},"500":{"description":"Internal server error"},"403":{"description":"User not a member of organization"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["API V1","orgs"],"summary":"Create new team","description":"Create a new team in the organization. Requires ORG_ADMIN role. Creator becomes TEAM_ADMIN.","operationId":"create_team_api_v1_orgs__org_id__teams_post","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TeamCreateRequest"}}}},"responses":{"201":{"description":"Team created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TeamItem"}}}},"404":{"description":"Organization not found"},"500":{"description":"Internal server error"},"403":{"description":"Insufficient permissions (requires ORG_ADMIN)"},"409":{"description":"Team with this code already exists in organization"},"422":{"description":"Validation error"}}}},"/api/v1/orgs/{org_id}/teams/{team_id}":{"get":{"tags":["API V1","orgs"],"summary":"Get team by ID","description":"Get team details if user has access to the team.","operationId":"get_team_api_v1_orgs__org_id__teams__team_id__get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"team_id","in":"path","required":true,"schema":{"type":"string","description":"Team UUID","title":"Team Id"},"description":"Team UUID"}],"responses":{"200":{"description":"Team found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TeamItem"}}}},"404":{"description":"Team not found or no access"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["API V1","orgs"],"summary":"Update team","description":"Update team details. Requires TEAM_ADMIN or ORG_ADMIN role.","operationId":"update_team_api_v1_orgs__org_id__teams__team_id__patch","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"team_id","in":"path","required":true,"schema":{"type":"string","description":"Team UUID","title":"Team Id"},"description":"Team UUID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TeamUpdateRequest"}}}},"responses":{"200":{"description":"Team updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TeamItem"}}}},"404":{"description":"Team not found or insufficient permissions"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["API V1","orgs"],"summary":"Delete team","description":"Soft delete team. Requires TEAM_ADMIN or ORG_ADMIN role. Deactivates all team memberships.","operationId":"delete_team_api_v1_orgs__org_id__teams__team_id__delete","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"team_id","in":"path","required":true,"schema":{"type":"string","description":"Team UUID","title":"Team Id"},"description":"Team UUID"}],"responses":{"204":{"description":"Team deleted successfully"},"404":{"description":"Team not found or insufficient permissions"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/orgs/{org_id}/teams/{team_id}/users":{"get":{"tags":["API V1","orgs"],"summary":"Get team members","description":"Get paginated list of team members with filtering and sorting.","operationId":"get_team_members_api_v1_orgs__org_id__teams__team_id__users_get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"team_id","in":"path","required":true,"schema":{"type":"string","description":"Team UUID","title":"Team Id"},"description":"Team UUID"},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number (1-based)","default":1,"title":"Page"},"description":"Page number (1-based)"},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Number of members per page","default":20,"title":"Page Size"},"description":"Number of members per page"},{"name":"search","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Search by name or email","title":"Search"},"description":"Search by name or email"},{"name":"role","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/MembershipRole"},{"type":"null"}],"description":"Filter by role","title":"Role"},"description":"Filter by role"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/MembershipStatus"},{"type":"null"}],"description":"Filter by status","default":"ACTIVE","title":"Status"},"description":"Filter by status"},{"name":"sort_by","in":"query","required":false,"schema":{"type":"string","description":"Sort field: name, email, role, created_at","default":"name","title":"Sort By"},"description":"Sort field: name, email, role, created_at"},{"name":"sort_order","in":"query","required":false,"schema":{"type":"string","pattern":"^(asc|desc)$","description":"Sort order","default":"asc","title":"Sort Order"},"description":"Sort order"}],"responses":{"200":{"description":"Team members retrieved","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TeamMembersPage"}}}},"404":{"description":"Team not found or no access"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/orgs/{org_id}/prompts":{"post":{"tags":["API V1","orgs","prompts"],"summary":"Create Prompt","description":"Create a new prompt with ORG, TEAM or PRIVATE visibility","operationId":"create_prompt_api_v1_orgs__org_id__prompts_post","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatePrompt"}}}},"responses":{"201":{"description":"Prompt created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Prompt"}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to create prompt"},"409":{"description":"Prompt with this identifier already exists"},"422":{"description":"Validation error"}}},"get":{"tags":["API V1","orgs","prompts"],"summary":"Get Active Prompts","description":"Get a paginated list of active prompts","operationId":"get_active_prompts_api_v1_orgs__org_id__prompts_get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"team_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"description":"Team UUID","title":"Team Id"},"description":"Team UUID"},{"name":"page_after","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Page After"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":50,"title":"Limit"}},{"name":"q","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Search string","title":"Q"},"description":"Search string"},{"name":"sort","in":"query","required":false,"schema":{"type":"string","description":"Sort order","default":"-created_at","title":"Sort"},"description":"Sort order"},{"name":"visibility","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/ResourceVisibility"},{"type":"null"}],"title":"Visibility"}},{"name":"tags","in":"query","required":false,"schema":{"anyOf":[{"type":"array","items":{"type":"string"}},{"type":"null"}],"title":"Tags"}}],"responses":{"200":{"description":"Prompt retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ListPromptsResponse"}}}},"404":{"description":"Prompt not found"},"500":{"description":"Internal server error"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to access prompt"},"422":{"description":"Validation error"}}}},"/api/v1/orgs/{org_id}/prompts/{prompt_id}":{"patch":{"tags":["API V1","orgs","prompts"],"summary":"Update Prompt","description":"Partial update of a prompt (name, content, visibility, tags, team_id)","operationId":"update_prompt_api_v1_orgs__org_id__prompts__prompt_id__patch","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"prompt_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Prompt UUID","title":"Prompt Id"},"description":"Prompt UUID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdatePrompt"}}}},"responses":{"200":{"description":"Prompt updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Prompt"}}}},"404":{"description":"Prompt not found"},"500":{"description":"Internal server error"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to update prompt"},"422":{"description":"Validation error"}}},"get":{"tags":["API V1","orgs","prompts"],"summary":"Get Prompt","description":"Fetch a prompt by its id","operationId":"get_prompt_api_v1_orgs__org_id__prompts__prompt_id__get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"prompt_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Prompt UUID","title":"Prompt Id"},"description":"Prompt UUID"}],"responses":{"200":{"description":"Prompt retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Prompt"}}}},"404":{"description":"Prompt not found"},"500":{"description":"Internal server error"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to access prompt"},"422":{"description":"Validation error"}}},"delete":{"tags":["API V1","orgs","prompts"],"summary":"Delete Prompt","description":"Soft delete a prompt by id","operationId":"delete_prompt_api_v1_orgs__org_id__prompts__prompt_id__delete","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"prompt_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Prompt UUID","title":"Prompt Id"},"description":"Prompt UUID"}],"responses":{"200":{"description":"Prompt deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Prompt"}}}},"404":{"description":"Prompt not found"},"500":{"description":"Internal server error"},"204":{"description":"Prompt deleted successfully"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to delete prompt"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/orgs/{org_id}/prompts/trash":{"get":{"tags":["API V1","orgs","prompts"],"summary":"Get Deleted Prompts","description":"Get a paginated list of deleted prompts","operationId":"get_deleted_prompts_api_v1_orgs__org_id__prompts_trash_get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"team_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"description":"Team UUID","title":"Team Id"},"description":"Team UUID"},{"name":"page_after","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Pagination cursor","title":"Page After"},"description":"Pagination cursor"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"description":"Number of prompts per page","default":50,"title":"Limit"},"description":"Number of prompts per page"},{"name":"q","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Search string","title":"Q"},"description":"Search string"},{"name":"sort","in":"query","required":false,"schema":{"type":"string","description":"Sort order","default":"-created_at","title":"Sort"},"description":"Sort order"},{"name":"visibility","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/ResourceVisibility"},{"type":"null"}],"title":"Visibility"}},{"name":"tags","in":"query","required":false,"schema":{"anyOf":[{"type":"array","items":{"type":"string"}},{"type":"null"}],"title":"Tags"}}],"responses":{"200":{"description":"Prompt retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ListPromptsResponse"}}}},"404":{"description":"Prompt not found"},"500":{"description":"Internal server error"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to access prompt"},"422":{"description":"Validation error"}}}},"/api/v1/orgs/{org_id}/prompts/code/{code}":{"get":{"tags":["API V1","orgs","prompts"],"summary":"Get Prompt By Code","description":"Fetch a prompt by its code","operationId":"get_prompt_by_code_api_v1_orgs__org_id__prompts_code__code__get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"code","in":"path","required":true,"schema":{"type":"string","description":"Prompt slug","title":"Code"},"description":"Prompt slug"}],"responses":{"200":{"description":"Prompt retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Prompt"}}}},"404":{"description":"Prompt not found"},"500":{"description":"Internal server error"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to access prompt"},"422":{"description":"Validation error"}}}},"/api/v1/orgs/{org_id}/prompts/{prompt_id}/restore":{"post":{"tags":["API V1","orgs","prompts"],"summary":"Restore Deleted Prompt","description":"Restore a deleted prompt","operationId":"restore_deleted_prompt_api_v1_orgs__org_id__prompts__prompt_id__restore_post","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"prompt_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Prompt UUID","title":"Prompt Id"},"description":"Prompt UUID"}],"responses":{"201":{"description":"Prompt created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Prompt"}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to create prompt"},"409":{"description":"Prompt with this identifier already exists"},"422":{"description":"Validation error"}}}},"/api/v1/orgs/{org_id}/prompts/batchDelete":{"post":{"tags":["API V1","orgs","prompts"],"summary":"Batch Delete","description":"Batch delete prompts by id","operationId":"batch_delete_api_v1_orgs__org_id__prompts_batchDelete_post","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchDelete"}}}},"responses":{"200":{"description":"Prompt deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchDeleteResponse"}}}},"404":{"description":"Prompt not found"},"500":{"description":"Internal server error"},"204":{"description":"Prompt deleted successfully"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to delete prompt"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/orgs/{org_id}/prompts/export":{"get":{"tags":["API V1","orgs","prompts"],"summary":"Export Prompts","description":"Export visible prompts as JSON","operationId":"export_prompts_api_v1_orgs__org_id__prompts_export_get","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"},{"name":"format","in":"query","required":false,"schema":{"type":"string","description":"The data format to export","default":"json","title":"Format"},"description":"The data format to export"}],"responses":{"200":{"description":"Prompt retrieved successfully","content":{"application/json":{"schema":{}}}},"404":{"description":"Prompt not found"},"500":{"description":"Internal server error"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to access prompt"},"422":{"description":"Validation error"}}}},"/api/v1/orgs/{org_id}/prompts/import":{"post":{"tags":["API V1","orgs","prompts"],"summary":"Import Prompts","description":"Bulk import prompts from csv/json","operationId":"import_prompts_api_v1_orgs__org_id__prompts_import_post","parameters":[{"name":"org_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","description":"Organization UUID","title":"Org Id"},"description":"Organization UUID"}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_import_prompts_api_v1_orgs__org_id__prompts_import_post"}}}},"responses":{"201":{"description":"Prompt created successfully","content":{"application/json":{"schema":{}}}},"404":{"description":"Not found"},"500":{"description":"Internal server error"},"401":{"description":"Not authenticated"},"403":{"description":"Insufficient permissions to create prompt"},"409":{"description":"Prompt with this identifier already exists"},"422":{"description":"Validation error"}}}}},"components":{"schemas":{"APIInfoResponse":{"properties":{"versions":{"additionalProperties":{"$ref":"#/components/schemas/APIVersionInfo"},"type":"object","title":"Versions","description":"Information about each API version"},"latest_version":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Latest Version","description":"Latest non-deprecated version"},"total_versions":{"type":"integer","title":"Total Versions","description":"Total number of versions"}},"type":"object","required":["versions","total_versions"],"title":"APIInfoResponse"},"APIVersionInfo":{"properties":{"deprecated":{"type":"boolean","title":"Deprecated","description":"Whether this version is deprecated"},"deprecation_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Deprecation Message","description":"Deprecation message if applicable"},"routes_count":{"type":"integer","title":"Routes Count","description":"Number of routes in this version"},"prefix":{"type":"string","title":"Prefix","description":"URL prefix for this version"}},"type":"object","required":["deprecated","routes_count","prefix"],"title":"APIVersionInfo"},"AuthProvider":{"type":"string","enum":["COGNITO","KEYCLOAK","OKTA","GOOGLE","MICROSOFT","APPLE","GITHUB","LOCAL"],"title":"AuthProvider","description":"Supported authentication providers."},"BatchDelete":{"properties":{"prompt_ids":{"items":{"type":"string","format":"uuid"},"type":"array","title":"Prompt Ids","description":"The prompt ids to delete"}},"additionalProperties":false,"type":"object","title":"BatchDelete"},"BatchDeleteResponse":{"properties":{"count":{"type":"integer","title":"Count","description":"The number of deleted prompts"}},"additionalProperties":false,"type":"object","required":["count"],"title":"BatchDeleteResponse"},"Body_import_prompts_api_v1_orgs__org_id__prompts_import_post":{"properties":{"file":{"type":"string","format":"binary","title":"File","description":"Upload file to create prompts"}},"type":"object","required":["file"],"title":"Body_import_prompts_api_v1_orgs__org_id__prompts_import_post"},"CircuitBreakerResponse":{"properties":{"summary":{"$ref":"#/components/schemas/CircuitBreakerSummary"},"services":{"additionalProperties":true,"type":"object","title":"Services","description":"Circuit breaker status by service"},"timestamp":{"type":"string","title":"Timestamp","description":"Response timestamp"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if operation failed"}},"type":"object","required":["summary","services","timestamp"],"title":"CircuitBreakerResponse"},"CircuitBreakerSummary":{"properties":{"total_circuit_breakers":{"type":"integer","title":"Total Circuit Breakers","description":"Total number of circuit breakers"},"open_circuit_breakers":{"type":"integer","title":"Open Circuit Breakers","description":"Number of open circuit breakers"},"healthy":{"type":"boolean","title":"Healthy","description":"True if no circuit breakers are open"}},"type":"object","required":["total_circuit_breakers","open_circuit_breakers","healthy"],"title":"CircuitBreakerSummary"},"ComprehensiveHealthResponse":{"properties":{"status":{"type":"string","title":"Status","example":"ok"},"version":{"type":"string","title":"Version","example":"1.0.0"},"stage":{"type":"string","title":"Stage","example":"prod"},"cache":{"additionalProperties":true,"type":"object","title":"Cache","description":"Cache health information"}},"type":"object","required":["status","version","stage","cache"],"title":"ComprehensiveHealthResponse"},"CreatePrompt":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"The title of the prompt"},"code":{"type":"string","title":"Code","description":"A url-safe unique identifier for the prompt"},"content":{"type":"string","minLength":1,"title":"Content","description":"The prompt content"},"visibility":{"$ref":"#/components/schemas/ResourceVisibility","description":"Controls access to the prompt","default":"PRIVATE"},"tags":{"items":{"type":"string"},"type":"array","title":"Tags","description":"List of tags for searching and categorizing prompts"},"team_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Team Id","description":"Optional identifier of the team within the organization"}},"additionalProperties":false,"type":"object","required":["name","code","content"],"title":"CreatePrompt"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","title":"Status","example":"ok"},"version":{"type":"string","title":"Version","example":"1.0.0"},"stage":{"type":"string","title":"Stage","example":"prod"}},"type":"object","required":["status","version","stage"],"title":"HealthResponse"},"ListPromptsResponse":{"properties":{"prompts":{"items":{"$ref":"#/components/schemas/Prompt"},"type":"array","title":"Prompts","description":"List of prompts"},"cursor":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cursor","description":"A pointer to the next prompt in the db"},"total":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Total","description":"The total number of prompts","default":0}},"additionalProperties":false,"type":"object","title":"ListPromptsResponse"},"MembershipRole":{"type":"string","enum":["ORG_ADMIN","TEAM_ADMIN","MEMBER","VIEWER"],"title":"MembershipRole","description":"Membership-level role.\n\nRoles are scoped **per Membership** (user↔org or user↔team):\n\n* **ORG_ADMIN** - full control at the organisation level\n    * Invite/remove users, manage billing, create & delete org-wide resources.\n    * *Does **not** automatically gain rights inside every team* - grant **TEAM_ADMIN** separately.\n\n* **TEAM_ADMIN** - full control inside one team\n    * CRUD libraries, docs, agents, tools in that team.\n    * Manage the team's member list and promote/demote members.\n\n* **MEMBER** - standard contributor\n    * Create/read/update resources in their team.\n    * Cannot delete users or change roles.\n\n* **VIEWER** - read-only auditor\n    * May view and export, but cannot create/edit/delete."},"MembershipStatus":{"type":"string","enum":["ACTIVE","INACTIVE","PENDING","REJECTED","SUSPENDED"],"title":"MembershipStatus","description":"Membership status."},"OrganizationCreateRequest":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"Organization name"},"code":{"type":"string","maxLength":64,"minLength":1,"title":"Code","description":"URL-safe identifier"},"default_timezone":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Default Timezone","description":"Default timezone"}},"additionalProperties":false,"type":"object","required":["name","code"],"title":"OrganizationCreateRequest","description":"Organization creation request."},"OrganizationItem":{"properties":{"id":{"type":"string","title":"Id","description":"Organization UUID"},"name":{"type":"string","title":"Name","description":"Organization display name"},"code":{"type":"string","title":"Code","description":"URL-safe organization identifier"},"status":{"$ref":"#/components/schemas/OrganizationStatus","description":"Organization status"},"trial_end_date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Trial End Date","description":"Trial expiration date"},"billing_cycle_anchor":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Billing Cycle Anchor","description":"Billing cycle anchor"},"default_timezone":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Default Timezone","description":"Default timezone"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Creation timestamp"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last update timestamp"},"deleted_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Deleted At","description":"Soft delete timestamp"}},"additionalProperties":false,"type":"object","required":["id","name","code","status","created_at","updated_at"],"title":"OrganizationItem","description":"Organization response model."},"OrganizationStatus":{"type":"string","enum":["TRIAL","ACTIVE","SUSPENDED","DEACTIVATED"],"title":"OrganizationStatus","description":"Organization status.\n\n* **TRIAL**     - Auto-created self-service tenant, within X-day free period.\n* **ACTIVE**    - Paying, in-good-standing organisation.\n* **SUSPENDED** - Temporarily blocked (billing failure ≥ X days, policy violation, or admin hold).\n* **DEACTIVATED** - Customer cancelled subscription but 30-day grace / export window still running."},"OrganizationUpdateRequest":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name","description":"Organization name"},"default_timezone":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Default Timezone","description":"Default timezone"}},"additionalProperties":false,"type":"object","title":"OrganizationUpdateRequest","description":"Organization update request."},"Prompt":{"properties":{"id":{"type":"string","format":"uuid","title":"Id","description":"Prompt UUID"},"name":{"type":"string","title":"Name","description":"Title of the prompt"},"code":{"type":"string","title":"Code","description":"URL-safe prompt identifier"},"content":{"type":"string","title":"Content","description":"Prompt content"},"org_id":{"type":"string","format":"uuid","title":"Org Id","description":"Parent organization UUID"},"created_by":{"type":"string","format":"uuid","title":"Created By","description":"Creator UUID"},"team_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Team Id","description":"Team UUID"},"tags":{"items":{"type":"string"},"type":"array","title":"Tags","description":"List of tags attached to the prompt"},"visibility":{"type":"string","title":"Visibility","description":"Access level of the prompt"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Creation timestamp"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last update timestamp"},"deleted_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Deleted At","description":"Soft delete timestamp"}},"additionalProperties":false,"type":"object","required":["id","name","code","content","org_id","created_by","tags","visibility","created_at","updated_at"],"title":"Prompt","description":"Prompt response model."},"ResourceVisibility":{"type":"string","enum":["ORG","TEAM","PRIVATE"],"title":"ResourceVisibility","description":"Sharing scope of a Resource.\n\n* **ORG**     - visible to everyone in the organisation.\n* **TEAM**    - visible to all members of a specific team/workspace.\n* **PRIVATE** - visible only to the creator until shared."},"TeamCreateRequest":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"Team name"},"code":{"type":"string","maxLength":64,"minLength":1,"title":"Code","description":"URL-safe identifier"},"description":{"anyOf":[{"type":"string","maxLength":1024},{"type":"null"}],"title":"Description","description":"Team description"}},"additionalProperties":false,"type":"object","required":["name","code"],"title":"TeamCreateRequest","description":"Team creation request."},"TeamItem":{"properties":{"id":{"type":"string","title":"Id","description":"Team UUID"},"name":{"type":"string","title":"Name","description":"Team display name"},"code":{"type":"string","title":"Code","description":"URL-safe team identifier"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Team description"},"organization_id":{"type":"string","title":"Organization Id","description":"Parent organization UUID"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Creation timestamp"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last update timestamp"},"deleted_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Deleted At","description":"Soft delete timestamp"}},"additionalProperties":false,"type":"object","required":["id","name","code","organization_id","created_at","updated_at"],"title":"TeamItem","description":"Team response model."},"TeamMemberItem":{"properties":{"user_id":{"type":"string","title":"User Id","description":"User UUID"},"email":{"type":"string","title":"Email","description":"User email"},"given_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Given Name","description":"Given name"},"family_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Family Name","description":"Family name"},"full_name":{"type":"string","title":"Full Name","description":"Full name"},"role":{"$ref":"#/components/schemas/MembershipRole","description":"Role in team"},"status":{"$ref":"#/components/schemas/MembershipStatus","description":"Membership status"},"joined_at":{"type":"string","format":"date-time","title":"Joined At","description":"When user joined team"},"is_active":{"type":"boolean","title":"Is Active","description":"User account active status"}},"additionalProperties":false,"type":"object","required":["user_id","email","full_name","role","status","joined_at","is_active"],"title":"TeamMemberItem","description":"Team member response model."},"TeamMembersPage":{"properties":{"items":{"items":{"$ref":"#/components/schemas/TeamMemberItem"},"type":"array","title":"Items","description":"Team members for this page"},"total":{"type":"integer","title":"Total","description":"Total number of team members"},"page":{"type":"integer","title":"Page","description":"Current page number"},"page_size":{"type":"integer","title":"Page Size","description":"Number of items per page"},"total_pages":{"type":"integer","title":"Total Pages","description":"Total number of pages"}},"additionalProperties":false,"type":"object","required":["items","total","page","page_size","total_pages"],"title":"TeamMembersPage","description":"Paginated team members response."},"TeamUpdateRequest":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name","description":"Team name"},"description":{"anyOf":[{"type":"string","maxLength":1024},{"type":"null"}],"title":"Description","description":"Team description"}},"additionalProperties":false,"type":"object","title":"TeamUpdateRequest","description":"Team update request."},"UpdatePrompt":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name","description":"The title of the prompt"},"content":{"anyOf":[{"type":"string","minLength":1},{"type":"null"}],"title":"Content","description":"The prompt content"},"visibility":{"anyOf":[{"$ref":"#/components/schemas/ResourceVisibility"},{"type":"null"}],"description":"Controls access to the prompt"},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags","description":"List of tags for searching and categorizing prompts"},"team_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Team Id","description":"Optional identifier of the team within the organization"}},"additionalProperties":false,"type":"object","title":"UpdatePrompt"},"UserIdentityItem":{"properties":{"provider":{"$ref":"#/components/schemas/AuthProvider","description":"Identity provider"},"subject":{"type":"string","title":"Subject","description":"Provider-specific user identifier"},"provider_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Provider Email","description":"Email address from provider"},"provider_username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Provider Username","description":"Username from provider"},"provider_metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Provider Metadata","description":"Additional provider data"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"When identity was first linked"}},"additionalProperties":false,"type":"object","required":["provider","subject","created_at"],"title":"UserIdentityItem","description":"User identity response model."},"UserItem":{"properties":{"id":{"type":"string","title":"Id","description":"Internal user UUID (stable across IdPs)"},"email":{"type":"string","title":"Email","description":"Primary email address"},"given_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Given Name","description":"Given name"},"family_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Family Name","description":"Family name"},"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name","description":"Computed full name"},"first_seen":{"type":"string","format":"date-time","title":"First Seen","description":"First login timestamp"},"last_login":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Login","description":"Most recent login"},"is_active":{"type":"boolean","title":"Is Active","description":"Account active status"},"identities":{"items":{"$ref":"#/components/schemas/UserIdentityItem"},"type":"array","title":"Identities","description":"All linked identity provider accounts"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Account creation timestamp"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last profile update"},"deleted_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Deleted At","description":"Soft delete timestamp"}},"additionalProperties":false,"type":"object","required":["id","email","first_seen","is_active","created_at","updated_at"],"title":"UserItem","description":"User profile response model."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}
